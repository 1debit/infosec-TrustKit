machine:
  xcode:
    version: 9.0
test:
  override:
    # First run Xcode 8.3 tests
    - ls /Applications/
    - sudo xcode-select --switch /Applications/Xcode-8.3.3.app
    # iOS 8 platform with iOS 9 SDK
    - xcodebuild clean test
      CODE_SIGNING_REQUIRED=NO
      CODE_SIGN_IDENTITY=
      -destination 'platform=iOS Simulator,name=iPhone 4S,OS=8.4'
      -sdk iphonesimulator9.3
      -scheme "TrustKit"
    # OS X 10.11 platform with OS X 10.11 SDK
    - xcodebuild clean test
      CODE_SIGNING_REQUIRED=NO
      CODE_SIGN_IDENTITY=
      -destination 'platform=OS X'
      -sdk macosx10.11
      -scheme "TrustKit OS X"

    # Switch to Xcode 9.0
    - sudo xcode-select --switch /Applications/Xcode-9.0.app
    # iOS 11 platform with iOS 11 SDK
    - xcodebuild clean test
      CODE_SIGNING_REQUIRED=NO
      CODE_SIGN_IDENTITY=
      -destination 'platform=iOS Simulator,name=iPhone 7,OS=11.0'
      -sdk iphonesimulator11.0
      -scheme "TrustKit"
    # tvOS 11 platform with tvOS 11 SDK
    - xcodebuild clean test
      CODE_SIGNING_REQUIRED=NO
      CODE_SIGN_IDENTITY=
      -destination 'platform=tvOS Simulator,name=Apple TV 1080p,OS=11.0'
      -sdk appletvsimulator11.0
      -scheme "TrustKit tvOS"
    # OS X 10.12 platform with OS X 10.12 SDK
    - xcodebuild clean test
      CODE_SIGNING_REQUIRED=NO
      CODE_SIGN_IDENTITY=
      -destination 'platform=OS X'
      -sdk macosx10.13
      -scheme "TrustKit OS X"

